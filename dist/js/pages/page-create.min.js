"use strict";!function(){$(".js-example-responsive2-currency").select2({width:"resolve",placeholder:"Валюта",minimumResultsForSearch:-1}),$(".js-example-responsive2").select2({width:"resolve",placeholder:"Выбрать",minimumResultsForSearch:-1}),$(".js-example-responsive3").select2({width:"resolve",placeholder:"Выбрать"}),$(".js-example-responsive4").select2({width:"resolve",placeholder:"Введите теги через запятую"}),$(".js-example-responsive5").select2({width:"resolve",placeholder:"--"}),document.addEventListener("DOMContentLoaded",()=>{setTimeout(()=>{document.querySelectorAll("input, select").forEach(e=>{e.value="",e.autocomplete="new-password"})},100)}),$(".my-select2").on("select2:opening",(function(e){$(".filter select").attr("style","display: none !important")})),$(".my-select2").on("select2:closing",(function(e){$(".filter select").attr("style","display: block !important")}));const e={location:"Локація: Парус",city:"місто: Дніпро",district:"район: Індустріальний",street:"вулиця: набережна Перемоги",residentialComplex:"назва комплексу: Sun City",typeRealEstate:"тип нерухомості: квартира",numberRooms:"кількість кімнат: 3",condition:"стан нерухомості: без ремонту",tags:"перелік додаткових тегів: парковка, дитячий майданчик, поруч магазини, панорамний вид з вікна"},t=t=>e[t]?e[t].split(":").slice(1).join(":").trim():null,n=`Згенеруй привабливий опис для оголошення нерухомості мінімум на 1500 слів\n\t\t українською мовою, російською, англійською. розділи ці 3 переклади через коди мов ua,ru,en Ось дані об'єкта:\n\t\t${Object.entries({"Локація":t("location"),"Місто":t("city"),"Район":t("district"),"Вулиця":t("street"),"Житловий комплекс":t("residentialComplex"),"Тип нерухомості":t("typeRealEstate"),"Кількість кімнат":t("numberRooms"),"Стан":t("condition"),"Додаткові переваги":t("tags")}).filter(([e,t])=>null!==t).map(([e,t])=>`- ${e}: ${t}`).join("\n")}\n\t\t`;document.querySelector("#generation-chat-gpt").addEventListener("click",async e=>{try{const e=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer АРІ_ключ"},body:JSON.stringify({model:"gpt-3.5-turbo",messages:[{role:"user",content:n}],temperature:1})});if(!e.ok)throw new Error("HTTP помилка! Статус: "+e.status);const t=await e.json();if(t.choices&&t.choices[0]){(e=>{const t=document.querySelectorAll(".description-for-advertising"),n=(e=>{const t=e.trim().split("\n\n"),n={};return t.forEach(e=>{const[t,...i]=e.split(":"),r=t.trim(),s=i.join(":").trim();n[r]=s}),n})(e);t.forEach(e=>{const t=e.dataset.textareaLang;n[t]&&(e.value=n[t])})})(t.choices[0].message.content)}}catch(e){console.error("Сталася помилка:",e)}});const i=document.querySelector(".btn-new-tel");let r=1;function s(e){const t=$(e),n=window.intlTelInput(e,{initialCountry:"ua",utilsScript:"https://cdn.jsdelivr.net/npm/intl-tel-input@25.3.1/build/js/utils.js",separateDialCode:!0,nationalMode:!0,autoPlaceholder:"aggressive",customPlaceholder:function(e,t){return e.replace(/[0-9]/g,"_")}}),i={ua:"(99) 999-99-99",us:"(999) 999-9999",gb:"9999 999999",de:"999 99999999",fr:"9 99-99-99-99",pl:"999 999-999",it:"999 999-9999",es:"999 99-99-99",default:"(999) 999-99-99"};function r(e){const n=i[e]||i.default;t.unmask().mask(n,{clearIfNotMatch:!0})}t.on("countrychange",(function(){r(n.getSelectedCountryData().iso2)})),t.on("keypress",(function(e){/[0-9]/.test(String.fromCharCode(e.which))||e.preventDefault()})),t.on("blur",(function(){if(t.val()){const e=n.getNumber();e&&t.val(e.replace(/[^\d]/g,""))}})),r(n.getSelectedCountryData().iso2),setTimeout((function(){t.trigger("countrychange")}),100)}i.addEventListener("click",e=>{const t=document.querySelectorAll(".right .item").length;if(t>=3)return void alert("Максимальна кількість телефонів - 3");r++;const n=document.querySelector(".create-filter-client-wrapper .right"),o=document.createElement("div");o.className="item",o.innerHTML=`\n        <label for="tel-contact${r}">Телефон</label>\n        <div class="item-inputText-wrapper">\n            <input class="item-inputText tel-contact" id="tel-contact${r}" type="tel" autocomplete="off">\n        </div>\n    `;const a=n.querySelector(".add_new-tel");n.insertBefore(o,a),s(o.querySelector(".tel-contact")),t+1>=3&&(i.style.display="none")}),document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelector(".tel-contact");if(e){s(e),r=1;document.querySelectorAll(".right .item").length>=3&&(document.querySelector(".btn-new-tel").style.display="none")}}));class o{constructor(e){this.inputId=e.inputId,this.wrapperClass=e.wrapperClass,this.checkImageSize=!1!==e.checkImageSize,this.checkImageSize&&(this.minWidth=e.minWidth||800,this.minHeight=e.minHeight||800),this.input=document.querySelector("#"+this.inputId),this.wrapper=document.querySelector("."+this.wrapperClass),this.errorContainer=this.wrapper?this.wrapper.querySelector(`[for="${this.inputId}"] span`):null,this.renderContainer=document.querySelector("document"===this.inputId?"[data-render-document]":"[data-render-plan]"),this.validDocuments=[],this.invalidDocuments=[],this.input&&this.wrapper&&this.errorContainer?this.init():console.error("Не вдалося знайти необхідні DOM-елементи")}init(){this.input.addEventListener("change",e=>this.handleFileUpload(e))}clearErrors(){if(!this.wrapper||!this.errorContainer)return;this.wrapper.classList.remove("error"),this.wrapper.style.marginBottom="";this.errorContainer.querySelectorAll("ul.error-list, li.error").forEach(e=>e.remove())}displayErrors(){if(this.wrapper&&this.errorContainer&&(this.clearErrors(),this.invalidDocuments.length>0)){this.wrapper.classList.add("error"),this.wrapper.style.marginBottom=16*this.invalidDocuments.length+"px";const e=document.createElement("ul");e.classList.add("error-list"),this.invalidDocuments.forEach(t=>{const n=document.createElement("li");n.textContent=t.text,n.classList.add("error"),e.appendChild(n)}),this.errorContainer.appendChild(e)}}handleFileUpload(e){const t=Array.from(e.target.files);this.validDocuments=[],this.invalidDocuments=[],t.forEach((e,n)=>{"application/pdf"===e.type?this.handlePDF(e):e.type.match("image.*")?this.handleImage(e,n,t.length):this.handleInvalidFile(e)}),t.every(e=>"application/pdf"===e.type)&&(this.displayErrors(),this.render())}handlePDF(e){this.validDocuments.push({id:this.validDocuments.length,name:e.name,size:e.size,width:null,height:null})}handleImage(e,t,n){const i=new Image,r=URL.createObjectURL(e);i.onload=()=>{URL.revokeObjectURL(r);const s=i.width,o=i.height;this.checkImageSize?s>=this.minWidth&&o>=this.minHeight?this.validDocuments.push({id:this.validDocuments.length,name:e.name,size:e.size,width:s,height:o}):this.invalidDocuments.push({text:`Зображення "${e.name}" (${s}x${o}) замаленьке. Мінімальний розмір: ${this.minWidth}x${this.minHeight} пікселів.`}):this.validDocuments.push({id:this.validDocuments.length,name:e.name,size:e.size,width:s,height:o}),t===n-1&&(this.displayErrors(),this.render())},i.onerror=()=>{URL.revokeObjectURL(r),this.invalidDocuments.push({text:"Помилка завантаження зображення: "+e.name}),this.displayErrors()},i.src=r}handleInvalidFile(e){this.invalidDocuments.push({text:`Файл "${e.name}" не є зображенням або PDF. Допустимі лише зображення (JPG/PNG) та PDF.`})}render(){this.renderContainer&&(this.renderContainer.innerHTML="",this.validDocuments.forEach(e=>{const t=document.createElement("div");t.className="badge rounded-pill document-item",t.setAttribute("data-document-id",e.id);const n=e.name.toLowerCase().endsWith(".pdf"),i=n?"iframe":"image",r=URL.createObjectURL(this.getFileByName(e.name));t.innerHTML=`\n                <span>${e.name}</span>\n                <button type="button" class="fancybox-button" data-fancybox data-type="${i}" data-src="${r}" aria-label="eye" data-id="${e.id}">\n                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">\n                    <path d="M14.5 8C14.5 8 11.6 12 8 12C4.4 12 1.5 8 1.5 8C1.5 8 4.4 4 8 4C11.6 4 14.5 8 14.5 8Z"\n                      stroke="#111111" stroke-width="1.5" stroke-miterlimit="10" stroke-linejoin="round"/>\n                    <path d="M8 10C9.10457 10 10 9.10457 10 8C10 6.89543 9.10457 6 8 6C6.89543 6 6 6.89543 6 8C6 9.10457 6.89543 10 8 10Z"\n                      stroke="#111111" stroke-width="1.5" stroke-miterlimit="10" stroke-linejoin="round"/>\n                  </svg>\n                </button>\n                <button type="button" aria-label="Close" class="remove-document" data-id="${e.id}">\n                  <svg width="10" height="10" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg">\n                    <path d="M0.932895 9.93359C0.708205 9.93359 0.483405 9.84787 0.311951 9.67641C-0.0310669 9.3334 -0.0310669 8.77754 0.311951 8.43452L8.43461 0.311868C8.77763 -0.0310395 9.33348 -0.0310395 9.67649 0.311868C10.0194 0.654776 10.0194 1.21074 9.67649 1.55365L1.55384 9.6763C1.38239 9.84787 1.15759 9.93359 0.932895 9.93359Z"\n                      fill="#111111"/>\n                    <path d="M9.05555 9.93348C8.83075 9.93348 8.60606 9.84776 8.43461 9.6763L0.311951 1.55365C-0.0310669 1.21074 -0.0310669 0.654776 0.311951 0.311868C0.654859 -0.0310395 1.21082 -0.0310395 1.55373 0.311868L9.67638 8.43452C10.0193 8.77754 10.0193 9.3334 9.67638 9.67641C9.50504 9.84776 9.28035 9.93348 9.05555 9.93348Z"\n                      fill="#111111"/>\n                  </svg>\n                </button>\n            `,this.renderContainer.appendChild(t)}),this.addRemoveHandlers(),this.initFancybox())}addRemoveHandlers(){this.renderContainer.querySelectorAll(".remove-document").forEach(e=>{e.addEventListener("click",t=>{t.preventDefault();const n=parseInt(e.getAttribute("data-id"));this.removeDocument(n)})})}removeDocument(e){this.validDocuments=this.validDocuments.filter(t=>t.id!==e),this.validDocuments.forEach((e,t)=>{e.id=t}),this.render()}getFileByName(e){return Array.from(this.input.files).find(t=>t.name===e)}initFancybox(){Fancybox.bind("[data-fancybox]",{Thumbs:!1,Toolbar:!0,Images:{zoom:!0}})}}function a(){new o({inputId:"document",wrapperClass:"loading-documents",checkImageSize:!1}),new o({inputId:"plan",wrapperClass:"loading-plan",minWidth:800,minHeight:800})}if("undefined"!=typeof Fancybox)a();else{const e=setInterval(()=>{window.Fancybox&&(clearInterval(e),a())},200)}}();