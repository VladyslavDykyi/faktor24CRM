"use strict";!function(){$(".js-example-responsive2-currency").select2({width:"resolve",placeholder:"Валюта",minimumResultsForSearch:-1}),$(".js-example-responsive2").select2({width:"resolve",placeholder:"Выбрать",minimumResultsForSearch:-1}),$(".js-example-responsive3").select2({width:"resolve",placeholder:"Выбрать"}),$(".js-example-responsive4").select2({width:"resolve",placeholder:"Введите теги через запятую"}),$(".js-example-responsive5").select2({width:"resolve",placeholder:"--"}),document.addEventListener("DOMContentLoaded",()=>{setTimeout(()=>{document.querySelectorAll("input, select").forEach(t=>{t.value="",t.autocomplete="new-password"})},100)}),$(".my-select2").on("select2:opening",(function(t){$(".filter select").attr("style","display: none !important")})),$(".my-select2").on("select2:closing",(function(t){$(".filter select").attr("style","display: block !important")}));const t={location:"Локація: Парус",city:"місто: Дніпро",district:"район: Індустріальний",street:"вулиця: набережна Перемоги",residentialComplex:"назва комплексу: Sun City",typeRealEstate:"тип нерухомості: квартира",numberRooms:"кількість кімнат: 3",condition:"стан нерухомості: без ремонту",tags:"перелік додаткових тегів: парковка, дитячий майданчик, поруч магазини, панорамний вид з вікна"},e=e=>t[e]?t[e].split(":").slice(1).join(":").trim():null,i=`Згенеруй привабливий опис для оголошення нерухомості мінімум на 1500 слів\n\t\t українською мовою, російською, англійською. розділи ці 3 переклади через коди мов ua,ru,en Ось дані об'єкта:\n\t\t${Object.entries({"Локація":e("location"),"Місто":e("city"),"Район":e("district"),"Вулиця":e("street"),"Житловий комплекс":e("residentialComplex"),"Тип нерухомості":e("typeRealEstate"),"Кількість кімнат":e("numberRooms"),"Стан":e("condition"),"Додаткові переваги":e("tags")}).filter(([t,e])=>null!==e).map(([t,e])=>`- ${t}: ${e}`).join("\n")}\n\t\t`;document.querySelector("#generation-chat-gpt").addEventListener("click",async t=>{try{const t=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer АРІ_ключ"},body:JSON.stringify({model:"gpt-3.5-turbo",messages:[{role:"user",content:i}],temperature:1})});if(!t.ok)throw new Error("HTTP помилка! Статус: "+t.status);const e=await t.json();if(e.choices&&e.choices[0]){(t=>{const e=document.querySelectorAll(".description-for-advertising"),i=(t=>{const e=t.trim().split("\n\n"),i={};return e.forEach(t=>{const[e,...n]=t.split(":"),o=e.trim(),r=n.join(":").trim();i[o]=r}),i})(t);e.forEach(t=>{const e=t.dataset.textareaLang;i[e]&&(t.value=i[e])})})(e.choices[0].message.content)}}catch(t){console.error("Сталася помилка:",t)}});const n=document.querySelector(".btn-new-tel");let o=1;function r(t){const e=$(t),i=window.intlTelInput(t,{initialCountry:"ua",utilsScript:"https://cdn.jsdelivr.net/npm/intl-tel-input@25.3.1/build/js/utils.js",separateDialCode:!0,nationalMode:!0,autoPlaceholder:"aggressive",customPlaceholder:function(t,e){return t.replace(/[0-9]/g,"_")}}),n={ua:"(99) 999-99-99",us:"(999) 999-9999",gb:"9999 999999",de:"999 99999999",fr:"9 99-99-99-99",pl:"999 999-999",it:"999 999-9999",es:"999 99-99-99",default:"(999) 999-99-99"};function o(t){const i=n[t]||n.default;e.unmask().mask(i,{clearIfNotMatch:!0})}e.on("countrychange",(function(){o(i.getSelectedCountryData().iso2)})),e.on("keypress",(function(t){/[0-9]/.test(String.fromCharCode(t.which))||t.preventDefault()})),e.on("blur",(function(){if(e.val()){const t=i.getNumber();t&&e.val(t.replace(/[^\d]/g,""))}})),o(i.getSelectedCountryData().iso2),setTimeout((function(){e.trigger("countrychange")}),100)}n.addEventListener("click",t=>{const e=document.querySelectorAll(".right .item").length;if(e>=3)return void alert("Максимальна кількість телефонів - 3");o++;const i=document.querySelector(".create-filter-client-wrapper .right"),s=document.createElement("div");s.className="item",s.innerHTML=`\n        <label for="tel-contact${o}">Телефон</label>\n        <div class="item-inputText-wrapper">\n            <input class="item-inputText tel-contact" id="tel-contact${o}" type="tel" autocomplete="off">\n        </div>\n    `;const a=i.querySelector(".add_new-tel");i.insertBefore(s,a),r(s.querySelector(".tel-contact")),e+1>=3&&(n.style.display="none")}),document.addEventListener("DOMContentLoaded",(function(){const t=document.querySelector(".tel-contact");if(t){r(t),o=1;document.querySelectorAll(".right .item").length>=3&&(document.querySelector(".btn-new-tel").style.display="none")}}));class s{constructor(t){this.inputId=t.inputId,this.wrapperClass=t.wrapperClass,this.checkImageSize=!1!==t.checkImageSize,this.checkImageSize&&(this.minWidth=t.minWidth||800,this.minHeight=t.minHeight||800),this.input=document.querySelector("#"+this.inputId),this.wrapper=document.querySelector("."+this.wrapperClass),this.errorContainer=this.wrapper,this.renderContainer=document.querySelector("document"===this.inputId?"[data-render-document]":"[data-render-plan]"),this.validDocuments=[],this.invalidDocuments=[],this.input&&this.wrapper&&this.errorContainer?this.init():console.error("Не вдалося знайти необхідні DOM-елементи")}init(){this.input.addEventListener("change",t=>this.handleFileUpload(t))}clearErrors(){if(!this.wrapper||!this.errorContainer)return;this.wrapper.classList.remove("error"),this.wrapper.style.marginBottom="";this.errorContainer.querySelectorAll("ul.error-list, li.error").forEach(t=>t.remove())}displayErrors(){if(this.wrapper&&this.errorContainer&&(this.clearErrors(),this.invalidDocuments.length>0)){this.wrapper.classList.add("error"),this.wrapper.style.marginBottom=16*this.invalidDocuments.length+"px";const t=document.createElement("ul");t.classList.add("error-list"),this.invalidDocuments.forEach(e=>{const i=document.createElement("li");i.textContent=e.text,i.classList.add("error"),t.appendChild(i)}),this.errorContainer.appendChild(t)}}handleFileUpload(t){const e=Array.from(t.target.files);this.validDocuments=[],this.invalidDocuments=[],e.forEach((t,i)=>{"application/pdf"===t.type?this.handlePDF(t):t.type.match("image.*")?this.handleImage(t,i,e.length):this.handleInvalidFile(t)}),e.every(t=>"application/pdf"===t.type)&&(this.displayErrors(),this.render())}handlePDF(t){this.validDocuments.push({id:this.validDocuments.length,name:t.name,size:t.size,width:null,height:null})}handleImage(t,e,i){const n=new Image,o=URL.createObjectURL(t);n.onload=()=>{URL.revokeObjectURL(o);const r=n.width,s=n.height;this.checkImageSize?r>=this.minWidth&&s>=this.minHeight?this.validDocuments.push({id:this.validDocuments.length,name:t.name,size:t.size,width:r,height:s}):this.invalidDocuments.push({text:`Зображення "${t.name}" (${r}x${s}) замаленьке. Мінімальний розмір: ${this.minWidth}x${this.minHeight} пікселів.`}):this.validDocuments.push({id:this.validDocuments.length,name:t.name,size:t.size,width:r,height:s}),e===i-1&&(this.displayErrors(),this.render())},n.onerror=()=>{URL.revokeObjectURL(o),this.invalidDocuments.push({text:"Помилка завантаження зображення: "+t.name}),this.displayErrors()},n.src=o}handleInvalidFile(t){this.invalidDocuments.push({text:`Файл "${t.name}" не є зображенням або PDF. Допустимі лише зображення (JPG/PNG) та PDF.`})}render(){this.renderContainer&&(this.renderContainer.innerHTML="",this.validDocuments.forEach(t=>{const e=document.createElement("div");e.className="badge rounded-pill document-item","plan"===this.inputId?e.setAttribute("data-plan-id",t.id):e.setAttribute("data-document-id",t.id);const i=t.name.toLowerCase().endsWith(".pdf"),n=i?"iframe":"image",o=URL.createObjectURL(this.getFileByName(t.name));e.innerHTML=`\n                <span>${t.name}</span>\n                <button type="button" class="fancybox-button" data-fancybox data-type="${n}" data-src="${o}" aria-label="eye" data-id="${t.id}">\n                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">\n                    <path d="M14.5 8C14.5 8 11.6 12 8 12C4.4 12 1.5 8 1.5 8C1.5 8 4.4 4 8 4C11.6 4 14.5 8 14.5 8Z"\n                      stroke="#111111" stroke-width="1.5" stroke-miterlimit="10" stroke-linejoin="round"/>\n                    <path d="M8 10C9.10457 10 10 9.10457 10 8C10 6.89543 9.10457 6 8 6C6.89543 6 6 6.89543 6 8C6 9.10457 6.89543 10 8 10Z"\n                      stroke="#111111" stroke-width="1.5" stroke-miterlimit="10" stroke-linejoin="round"/>\n                  </svg>\n                </button>\n                <button type="button" aria-label="Close" class="remove-document" data-id="${t.id}">\n                  <svg width="10" height="10" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg">\n                    <path d="M0.932895 9.93359C0.708205 9.93359 0.483405 9.84787 0.311951 9.67641C-0.0310669 9.3334 -0.0310669 8.77754 0.311951 8.43452L8.43461 0.311868C8.77763 -0.0310395 9.33348 -0.0310395 9.67649 0.311868C10.0194 0.654776 10.0194 1.21074 9.67649 1.55365L1.55384 9.6763C1.38239 9.84787 1.15759 9.93359 0.932895 9.93359Z"\n                      fill="#111111"/>\n                    <path d="M9.05555 9.93348C8.83075 9.93348 8.60606 9.84776 8.43461 9.6763L0.311951 1.55365C-0.0310669 1.21074 -0.0310669 0.654776 0.311951 0.311868C0.654859 -0.0310395 1.21082 -0.0310395 1.55373 0.311868L9.67638 8.43452C10.0193 8.77754 10.0193 9.3334 9.67638 9.67641C9.50504 9.84776 9.28035 9.93348 9.05555 9.93348Z"\n                      fill="#111111"/>\n                  </svg>\n                </button>\n            `,this.renderContainer.appendChild(e)}),this.addRemoveHandlers(),this.initFancybox())}addRemoveHandlers(){this.renderContainer.querySelectorAll(".remove-document").forEach(t=>{t.addEventListener("click",e=>{e.preventDefault();const i=parseInt(t.getAttribute("data-id"));this.removeDocument(i)})})}removeDocument(t){this.validDocuments=this.validDocuments.filter(e=>e.id!==t),this.validDocuments.forEach((t,e)=>{t.id=e}),this.render()}getFileByName(t){return Array.from(this.input.files).find(e=>e.name===t)}initFancybox(){Fancybox.bind("[data-fancybox]",{Thumbs:!1,Toolbar:!0,Images:{zoom:!0}})}}function a(){new s({inputId:"document",wrapperClass:"loading-documents",checkImageSize:!1}),new s({inputId:"plan",wrapperClass:"loading-plan",minWidth:800,minHeight:800})}if(new class{constructor(t){this.inputId=t.inputId,this.wrapperClass=t.wrapperClass||"photo-info-list",this.checkImageSize=!1!==t.checkImageSize,this.minWidth=t.minWidth||800,this.minHeight=t.minHeight||800,this.input=document.querySelector("#"+this.inputId),this.wrapper=document.querySelector("."+this.wrapperClass),this.errorContainer=this.wrapper?this.wrapper.querySelector(".error-container"):null,this.renderContainer=document.querySelector(".photo-info-list"),this.validPhotos=[],this.invalidPhotos=[],this.photoArray=[],this.input&&this.wrapper?this.init():console.error("Не вдалося знайти необхідні DOM-елементи")}init(){this.input.addEventListener("change",t=>this.handleFileUpload(t))}handleFileUpload(t){const e=Array.from(t.target.files);this.validPhotos=[],this.invalidPhotos=[],this.photoArray=[],e.forEach((t,i)=>{t.type.match("image.*")?this.handleImage(t,i,e.length):this.handleInvalidFile(t)})}handleImage(t,e,i){const n=new Image,o=URL.createObjectURL(t);n.onload=()=>{URL.revokeObjectURL(o);const r=n.width,s=n.height;if(!this.checkImageSize||r>=this.minWidth&&s>=this.minHeight){const e={id:this.validPhotos.length,name:t.name,size:t.size,width:r,height:s,file:t,isMain:0===this.validPhotos.length};this.validPhotos.push(e),this.photoArray.push(e)}else this.invalidPhotos.push({text:`Зображення "${t.name}" (${r}x${s}) замаленьке. Мінімальний розмір: ${this.minWidth}x${this.minHeight} пікселів.`,file:t});e===i-1&&(this.displayErrors(),this.render())},n.onerror=()=>{URL.revokeObjectURL(o),this.invalidPhotos.push({text:"Помилка завантаження зображення: "+t.name,file:t}),this.displayErrors()},n.src=o}handleInvalidFile(t){this.invalidPhotos.push({text:`Файл "${t.name}" не є зображенням. Допустимі лише зображення (JPG/PNG).`,file:t})}clearErrors(){if(!this.wrapper||!this.errorContainer)return;this.wrapper.classList.remove("error");this.errorContainer.querySelectorAll(".error").forEach(t=>t.remove())}displayErrors(){this.wrapper&&this.errorContainer&&(this.clearErrors(),this.invalidPhotos.length>0&&(this.wrapper.classList.add("error"),this.invalidPhotos.forEach(t=>{const e=document.createElement("div");e.textContent=t.text,e.classList.add("error"),this.errorContainer.appendChild(e)})))}render(){this.renderContainer&&(this.destroyTooltips(),this.renderContainer.innerHTML="",this.photoArray.forEach((t,e)=>{const i=document.createElement("li");i.classList.add("photo-info-item"),i.setAttribute("data-photo-id",t.id);const n=URL.createObjectURL(t.file);i.innerHTML=`\n                <label>\n                    <input type="radio" name="main-photo" ${t.isMain?"checked":""}\n                           data-id="${t.id}">\n                       <div>\n                 \t     <img src="${n}" alt="${t.name}"\n                         data-bs-toggle="tooltip" data-bs-placement="top"\n                         data-bs-title="${t.isMain?"Головне фото":"Натисніть, щоб зробити головним"}">\n                       </div>\n                </label>\n                <div class="photo-info-item-actions">\n                    <button type="button" class="btn-see" aria-label="eye"\n                            data-fancybox data-src="${n}">\n                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n                            <path d="M14.5 8C14.5 8 11.6 12 8 12C4.4 12 1.5 8 1.5 8C1.5 8 4.4 4 8 4C11.6 4 14.5 8 14.5 8Z" stroke="#3585F5" stroke-width="1.5" stroke-miterlimit="10" stroke-linejoin="round" />\n                            <path d="M8 10C9.10457 10 10 9.10457 10 8C10 6.89543 9.10457 6 8 6C6.89543 6 6 6.89543 6 8C6 9.10457 6.89543 10 8 10Z" stroke="#3585F5" stroke-width="1.5" stroke-miterlimit="10" stroke-linejoin="round" />\n                        </svg>\n                    </button>\n                    <button type="button" class="btn-move" data-id="${t.id}">\n                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n                            <g clip-path="url(#clip0_388_3868)">\n                                <path d="M3.33301 6L1.33301 8L3.33301 10" stroke="#3585F5" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />\n                                <path d="M6 3.33301L8 1.33301L10 3.33301" stroke="#3585F5" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />\n                                <path d="M10 12.667L8 14.667L6 12.667" stroke="#3585F5" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />\n                                <path d="M12.667 6L14.667 8L12.667 10" stroke="#3585F5" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />\n                                <path d="M1.33301 8H14.6663" stroke="#3585F5" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />\n                                <path d="M8 1.33301V14.6663" stroke="#3585F5" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />\n                            </g>\n                            <defs>\n                                <clipPath id="clip0_388_3868">\n                                    <rect width="16" height="16" fill="white" />\n                                </clipPath>\n                            </defs>\n                        </svg>\n                    </button>\n                    <button type="button" class="btn-delete" data-id="${t.id}">\n                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n                            <path d="M4.30007 12.4999C4.09537 12.4999 3.89057 12.4218 3.73437 12.2656C3.42188 11.9531 3.42188 11.4467 3.73437 11.1342L11.1343 3.7343C11.4468 3.4219 11.9532 3.4219 12.2657 3.7343C12.5781 4.0467 12.5781 4.55319 12.2657 4.86559L4.86576 12.2655C4.70956 12.4218 4.50477 12.4999 4.30007 12.4999Z" fill="#3585F5" />\n                            <path d="M11.7 12.4998C11.4952 12.4998 11.2905 12.4217 11.1343 12.2655L3.73437 4.86559C3.42188 4.55319 3.42188 4.0467 3.73437 3.7343C4.04677 3.4219 4.55327 3.4219 4.86566 3.7343L12.2656 11.1342C12.578 11.4467 12.578 11.9531 12.2656 12.2656C12.1095 12.4217 11.9048 12.4998 11.7 12.4998Z" fill="#3585F5" />\n                        </svg>\n                    </button>\n                </div>\n            `,this.renderContainer.prepend(i)}),this.initEventHandlers(),this.initFancybox(),this.initTooltips())}initEventHandlers(){this.renderContainer.querySelectorAll('input[type="radio"]').forEach(t=>{t.addEventListener("change",t=>{const e=parseInt(t.target.dataset.id);this.setMainPhoto(e)})}),this.renderContainer.querySelectorAll(".btn-delete").forEach(t=>{t.addEventListener("click",t=>{const e=parseInt(t.currentTarget.dataset.id);this.deletePhoto(e)})}),this.renderContainer.querySelectorAll(".btn-move").forEach(t=>{t.addEventListener("click",t=>{const e=parseInt(t.currentTarget.dataset.id);this.movePhoto(e)})})}setMainPhoto(t){this.photoArray.forEach(e=>{e.isMain=e.id===t}),this.render()}deletePhoto(t){const e=this.photoArray.find(e=>e.id===t);if(e&&e.file){const t=URL.createObjectURL(e.file);URL.revokeObjectURL(t)}this.photoArray=this.photoArray.filter(e=>e.id!==t),this.validPhotos=this.validPhotos.filter(e=>e.id!==t),this.photoArray.forEach((t,e)=>{t.id=e,0===e&&(t.isMain=!0)}),this.validPhotos.forEach((t,e)=>{t.id=e}),this.render()}movePhoto(t){console.log("Move photo with id: "+t)}initFancybox(){"undefined"!=typeof Fancybox&&(Fancybox.getInstance()&&Fancybox.getInstance().destroy(),Fancybox.bind("[data-fancybox]",{Thumbs:!1,Toolbar:!0,Images:{zoom:!0},on:{close:()=>{const t=Fancybox.getInstance();if(t){const e=t.getSlides();e&&e.forEach&&e.forEach(t=>{t.content&&t.content.src&&t.content.src.startsWith("blob:")&&URL.revokeObjectURL(t.content.src)})}},destroy:()=>{Fancybox.getInstance()&&Fancybox.getInstance().destroy()}}}))}initTooltips(){"undefined"!=typeof bootstrap&&bootstrap.Tooltip&&(this.destroyTooltips(),this.tooltips=[],this.renderContainer.querySelectorAll('[data-bs-toggle="tooltip"]').forEach(t=>{this.tooltips.push(new bootstrap.Tooltip(t,{trigger:"hover"}))}))}destroyTooltips(){this.tooltips&&(this.tooltips.forEach(t=>{t.dispose()}),this.tooltips=[])}}({inputId:"loading-photo",minWidth:800,minHeight:800,wrapperClass:"photo-info-list"}),"undefined"!=typeof Fancybox)a();else{const t=setInterval(()=>{window.Fancybox&&(clearInterval(t),a())},200)}}();