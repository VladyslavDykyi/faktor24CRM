<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport"
		  content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>Page-create</title>
	<link rel="shortcut icon" href="./img/favicon.ico" type="image/x-icon">
	<link rel="stylesheet" href="./css/lib/select2.min.css">
	<link rel="stylesheet" href="./css/lib/bootstrap.v5.3.3.min.css">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/intl-tel-input@25.3.1/build/css/intlTelInput.css">
	<link href="https://cdn.datatables.net/v/dt/dt-2.2.2/datatables.min.css" rel="stylesheet" integrity="sha384-2vMryTPZxTZDZ3GnMBDVQV8OtmoutdrfJxnDTg0bVam9mZhi7Zr3J1+lkVFRr71f" crossorigin="anonymous">
	<link rel="stylesheet" href="./css/pages/page-create.min.css">
</head>
<body class="d-flex flex-column min-vh-100">
<main class="wrapper">
	<!-- початок side-bar	-->
	@@include('./html/_side-bar.html')
	<!-- кінець side-bar	-->
	<!-- початок main	-->
	@@include('./html/page-create/_page-create.html')
	<!-- кінець main	-->
</main>
<!-- початок цей блок ще в розробці _modal	-->
@@include('./html/_modal.html')
<!-- кінець цей блок ще в розробці _modal	-->
<script src="./js/lib/popper.v2.11.8.min.js"></script>
<script src="./js/lib/bootstrap.v5.3.3.min.js"></script>
<script src="./js/lib/jquery.v3.7.1.min.js"></script>
<script src="./js/lib/data-tables.min.js"></script>
<script src="./js/lib/moment.min.js"></script>
<script src="./js/lib/data-range-picker.min.js"></script>
<script src="./js/lib/select2.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/intl-tel-input@25.3.1/build/js/intlTelInput.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js"></script>
<script>
	$(function() {
		const $input = $("#tel-contact");
		
		// Ініціалізація intl-tel-input
		const iti = window.intlTelInput($input.get(0), {
			initialCountry: "ua",
			utilsScript: "https://cdn.jsdelivr.net/npm/intl-tel-input@25.3.1/build/js/utils.js",
			separateDialCode: true, // Вимкнути відокремлений код країни
			nationalMode: true, // Використовувати національний формат
			autoPlaceholder: "aggressive", // Агресивне оновлення плейсхолдера
			customPlaceholder: function(placeholder, countryData) {
				// Генеруємо маску з підкресленнями
				return placeholder.replace(/[0-9]/g, '_');
			}
		});
		
		// Маски для різних країн (без кодів країн)
		const countryMasks = {
			'ua': '(99) 999-99-99',
			'us': '(999) 999-9999',
			'gb': '9999 999999',
			'de': '999 99999999',
			'fr': '9 99-99-99-99',
			'pl': '999 999-999',
			'it': '999 999-9999',
			'es': '999 99-99-99',
			'default': '(999) 999-99-99'
		};
		
		// Функція для застосування маски
		function applyPhoneMask(countryCode) {
			const mask = countryMasks[countryCode] || countryMasks['default'];
			$input.unmask().mask(mask, {
				clearIfNotMatch: true
			});
		}
		
		// Обробник зміни країни
		$input.on('countrychange', function() {
			applyPhoneMask(iti.getSelectedCountryData().iso2);
		});
		
		// Обмеження введення лише цифр
		$input.on('keypress', function(e) {
			if (!/[0-9]/.test(String.fromCharCode(e.which))) {
				e.preventDefault();
			}
		});
		
		// Автоматичне форматування при втраті фокусу
		$input.on('blur', function() {
			if ($input.val()) {
				const number = iti.getNumber();
				if (number) {
					$input.val(number.replace(/[^\d]/g, '')); // Просто цифри
				}
			}
		});
		
		// Ініціалізація при завантаженні
		applyPhoneMask(iti.getSelectedCountryData().iso2);
		
		// Додаткове налаштування для коректного відображення
		setTimeout(function() {
			$input.trigger('countrychange');
		}, 100);
	});
</script>
<script src="./js/pages/page-complex-table.js"></script>
<script src="./js/pages/full-filter.min.js"></script>
<script src="./js/pages/my-dropdown.min.js"></script>
<script src="./js/pages/page-create.min.js"></script>
<script src="./js/pages/page-complex.min.js"></script>

</body>
</html>